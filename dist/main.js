!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("url-parse")):"function"==typeof define&&define.amd?define(["url-parse"],r):"object"==typeof exports?exports.CanvasSprite=r(require("url-parse")):e.CanvasSprite=r(e.URLParse)}(window,(function(e){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=1)}([function(r,t){r.exports=e},function(e,r,t){"use strict";t.r(r),t.d(r,"loadImage",(function(){return a}));var n=t(0),o=t.n(n);var i=function(e){if(!e||"string"!=typeof e)throw new Error("url is required and should be string");return!/^data:/.test(e)&&new o.a(e).origin!==window.location.origin};function a(e){return new Promise((function(r,t){var n=new Image;i(e)&&(n.crossOrigin="anonymous"),n.onload=function(){n.setAttribute("data-loaded","true"),r(n)},n.onerror=function(){t(Error("load ".concat(e," error")))},n.src=e}))}function u(e){return"number"==typeof e&&parseInt(e)===e}function c(e){var r=e.canvas,t=e.imageUrl,n=e.frames,o=e.fps,i=e.loop,c=void 0===i||i,f=e.onEnd,d=e.onLoop;if(!r)throw new Error("canvas is required");if(!t)throw new Error("imageUrl is required");if(!u(n))throw new Error("frames is required and should be integer");if(!u(o))throw new Error("fps is required and should be integer");if(r.hasAttribute("data-cs-id"))throw new Error("the canvas has sprite with it, call .destroy() first");r.setAttribute("data-cs-id","cs-".concat(Date.now()));var s=r.getContext("2d"),l=null,p=!1,w=0,m=null,h=0,g=0,b=0,v=1e3/o,y=0;function x(){l=window.requestAnimationFrame(x),!p&&m&&(g=Date.now(),(y=g-b)>=v&&(b=g-y%v,j(),w===n-1?c?(w=0,h++,d&&d(h)):(p=!0,window.cancelAnimationFrame(l),f&&f()):w+=1))}function j(){var e=m.width,r=m.height;w<n&&(s.clearRect(0,0,e,r),s.drawImage(m,w*e/n,0,e/n,r,0,0,e/n,r))}function q(e){m=e;var t=e.width/n,o=e.height;r&&(r.width=t,r.height=o,b=Date.now(),j(),x())}return t instanceof Image?q(t):a(t).then(q),{play:function(){p=!1},pause:function(){p=!0},stop:function(){p=!0,w=0,j()},destroy:function(){p=!1,m=null,l&&window.cancelAnimationFrame(l),s&&s.clearRect(0,0,r.width,r.height),r&&r.removeAttribute("data-cs-id"),l=null,s=null,r=null}}}c.loadImage=a;r.default=c}]).default}));